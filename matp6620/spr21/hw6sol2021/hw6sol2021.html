<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title></title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html --> 
<meta name="src" content="hw6sol2021.tex"> 
<meta name="date" content="2021-05-17 20:01:00"> 
<link rel="stylesheet" type="text/css" href="hw6sol2021.css"> 
</head><body 
>
<div class="center" 
>
<!--l. 30--><p class="noindent" >
<!--l. 33--><p class="noindent" ><a 
href="http://www.rpi.edu/~mitchj/matp6620" ><span 
class="cmr-12x-x-120">MATP6620 / ISYE6760</span><br />
<span 
class="cmr-12x-x-120">Combinatorial Optimization and Integer Programming</span></a><br />
<span 
class="cmr-12x-x-120">Homework 6.</span><br />
<span 
class="cmr-12x-x-120">Solutions</span>
</div>
                                                                                         <div class="flushright" 
>
<!--l. 38--><p class="noindent" >
 Due: Thursday, April 29, 2021.<br />
Penalty for late homeworks: 10% for each day or part of a day.</div>
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-3x1">Solve the Held-Karp 1-tree Lagrangian dual problem for the graph with edge costs given
      below:
      <center class="math-display" >
      <img 
src="hw6sol20210x.png" alt="   |  1   2   3   4   5   6
---|------------------------
 1 | -   10   9  14   5  14
 2 |10   -   11  10   7  10
 3 |  9  11  -    8   9  14
 4 |14   10   8  -    9  13
   |
 5 |  5   7   9   9  -    8
 6 |14   10  14  13   8  -
      " class="math-display" ></center>
      <!--l. 121--><p class="nopar" >
      (Hint: The optimal Lagrangian multipliers are integral.)
      <!--l. 126--><p class="noindent" ><span 
class="cmbx-12">Solution:</span>
      <!--l. 129--><p class="noindent" >We initialize with all Lagrangian multipliers equal to zero, giving a solution:
      <div class="center" 
>
<!--l. 131--><p class="noindent" >
                                                                                         
                                                                                         
<!--l. 143--><p class="noindent" >
<img src=q1a.png>
</div>
      <!--l. 146--><p class="noindent" >Following equation (3.14) on page 484 of the text, we set up the Lagrangian relaxation
      as
      <table 
class="equation"><tr><td><a 
 id="x1-4r1"></a>
      <center class="math-display" >
      <img 
src="hw6sol20211x.png" alt="                           (                       )
           &#x2211;               {  &#x2211;                    }
z1T(&#x03BB; ) = 2    &#x03BB;i +  min           (cij - &#x03BB;i - &#x03BB;j)xij .
           i&#x2208;V      x is1-tree( (i,j)&#x2208;E                )
      " class="math-display" ></center></td><td class="equation-label">(1)</td></tr></table>
      <!--l. 150--><p class="nopar" >
      <!--l. 152--><p class="noindent" >We adjust <span 
class="cmmi-12">&#x03BB; </span>according to the degrees of the vertices in the initial 1-tree, leading to the
      choice
      <center class="math-display" >
      <img 
src="hw6sol20212x.png" alt="&#x03BB; = (0,1, 0,0,- 2,1).
      " class="math-display" ></center>
      <!--l. 156--><p class="nopar" >
      <!--l. 158--><p class="noindent" >The modified cost matrix and an optimal 1-tree are then:
                                                                                         
                                                                                         
      <div class="tabular"> <table id="TBL-1" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-1-1g"><col 
id="TBL-1-1"><col 
id="TBL-1-2"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-1-1-"><td  style="white-space:wrap; text-align:left;" id="TBL-1-1-1"  
class="td11"><center class="par-math-display" >
<img 
src="hw6sol20213x.png" alt="   |
---|-1----2---3---4---5---6-
 1 | -    9   9  14   7  13
 2 | 9   -   10   9   8   8
   |
 3 | 9  10   -    8  11  13
 4 |14    9   8  -   11  12
 5 | 7    8  11  11  -    9
 6 |13    8  13  12   9  -
" class="par-math-display" ></center>
<!--l. 171--><p class="nopar" >                        </td><td  style="white-space:wrap; text-align:left;" id="TBL-1-1-2"  
class="td11"><!--l. 184--><p class="noindent" >
<img src=q1b.png>                                                          </td>
</tr></table></div>
      <!--l. 188--><p class="noindent" >We adjust <span 
class="cmmi-12">&#x03BB; </span>according to the degrees of the vertices in the current 1-tree, leading to the
      choice
      <center class="math-display" >
      <img 
src="hw6sol20214x.png" alt="&#x03BB; = (0,0, 0,0,- 2,2).
      " class="math-display" ></center>
      <!--l. 192--><p class="nopar" >
      <!--l. 194--><p class="noindent" >The modified cost matrix and an optimal 1-tree are then:
      <div class="tabular"> <table id="TBL-2" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1"><col 
id="TBL-2-2"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-1-1"  
class="td11"><center class="par-math-display" >
<img 
src="hw6sol20215x.png" alt="   |
   | 1    2   3   4   5   6
-1-|----10----9--14---7--12-
   |
 2 |10   -   11  10   9   8
 3 | 9  11   -    8  11  12
 4 |14  10    8  -   11  11
 5 | 7    9  11  11  -    8
 6 |12    8  12  11   8  -
   |
" class="par-math-display" ></center>
<!--l. 207--><p class="nopar" >                        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-1-2"  
class="td11"><!--l. 220--><p class="noindent" >
<img src=q1c.png>                                                          </td>
</tr></table></div>
      <!--l. 224--><p class="noindent" >Since this is a tour, it is optimal, with value 50.
      </li>
      <li 
  class="enumerate" id="x1-6x2">The graph <span 
class="cmmi-12">G </span>= (<span 
class="cmmi-12">V,E</span>) is as follows:
                                                                                         
                                                                                         
      <div class="center" 
>
<!--l. 319--><p class="noindent" >
<!--l. 389--><p class="noindent" > <img src=q2.png>
</div>
      <!--l. 439--><p class="noindent" >One unit of commodity A must be shipped from <span 
class="cmmi-12">a </span>to <span 
class="cmmi-12">k </span>and one unit of commodity B must
      be shipped from <span 
class="cmmi-12">h </span>to&#x00A0;<span 
class="cmmi-12">f</span>. The flows must be integral. The cost of shipping one unit of flow
      along an arc is one for each commodity, and the total capacity of each arc is also one. The
      capacity is the sum of the flow in both directions. A Lagrangian relaxation for the integer
      multicommodity flow problem could be constructed by placing the upper bound
      constraints on the arcs in the objective function. If the Lagrangian multipliers are set
      equal to zero, what is the value of the Lagrangian relaxation? Find a choice of
      Lagrangian multipliers for which the optimal solution to the Lagrangian relaxation
      gives the optimal solution to the multicommodity flow problem. How does the
      optimal value of the Lagrangian relaxation compare to the optimal value of the LP
      relaxation?
      <!--l. 457--><p class="noindent" ><span 
class="cmbx-12">Solution:</span>
      <!--l. 459--><p class="noindent" >Let <span 
class="cmmi-12">E </span>denote the set of edges and <span 
class="cmmi-12">V </span>the set of vertices. Let <span 
class="cmmi-12">x</span><sub><span 
class="cmmi-8">e</span></sub><sup><span 
class="cmmi-8">q</span></sup> denote the flow
      of commodity <span 
class="cmmi-12">q </span>on edge&#x00A0;<span 
class="cmmi-12">e </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="cmmi-12">E</span>. We denote the two commodities as <span 
class="cmmi-12">q </span>= <span 
class="cmmi-12">ak </span>and
      <span 
class="cmmi-12">q </span>= <span 
class="cmmi-12">hf</span>. Let <span 
class="cmmi-12">s</span>(<span 
class="cmmi-12">q</span>) and <span 
class="cmmi-12">t</span>(<span 
class="cmmi-12">q</span>) denote the start and end vertices for commodity&#x00A0;<span 
class="cmmi-12">q</span>.
      Let <span 
class="cmmi-12">&#x03B4;</span><sup><span 
class="cmr-8">+</span></sup>(<span 
class="cmmi-12">v</span>) denote the edges leaving node&#x00A0;<span 
class="cmmi-12">v</span>, and <span 
class="cmmi-12">&#x03B4;</span><sup><span 
class="cmsy-8">-</span></sup>(<span 
class="cmmi-12">v</span>) the set of edges entering
      node&#x00A0;<span 
class="cmmi-12">v</span>.
      <!--l. 466--><p class="noindent" >The Lagrangian relaxation is
      <center class="math-display" >
      <img 
src="hw6sol20216x.png" alt="            &#x2211;   &#x2211;          &#x2211;       ( &#x2211;         )
minx                  xqe +       &#x03BB;e     xqe - 1
            &#x2211; q   e&#x2208;E   q   &#x2211;e&#x2208;E       qq
subject to  &#x2211; e&#x2208;&#x03B4;+(s(q))xe - &#x2211; e&#x2208;&#x03B4;-(s(q))xe  =  1  for q = ak,hf
               e&#x2208; &#x03B4;- (t(q))xqe -    e&#x2208;&#x03B4;+(t(q))xqe  =  1  for q = ak,hf
                &#x2211;         q   &#x2211;         q
                  e&#x2208;&#x03B4;+(v)xe -   e&#x2208;&#x03B4;-(v)xe  =  0  for v &#x2044;= s(q),t(q),for q = ak,hf
                                       xqe  &#x2265;  0  for e &#x2208; E, q = ak,hf
      " class="math-display" ></center>
      <!--l. 477--><p class="nopar" >
      When <span 
class="cmmi-12">&#x03BB;</span><sub><span 
class="cmmi-8">e</span></sub> = 0 for all <span 
class="cmmi-12">e </span><span 
class="cmsy-10x-x-120">&#x2208; </span><span 
class="cmmi-12">E</span>, the optimal value of the Lagrangian relaxation is 6, achieved
      by the path <span 
class="cmmi-12">h </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">j </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">k </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">f </span>for commodity <span 
class="cmmi-12">hf</span>, and by the path <span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">b </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">j </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">k </span>for
      commodity&#x00A0;<span 
class="cmmi-12">ak</span>.
      <!--l. 483--><p class="noindent" >Both paths use the edge <span 
class="cmmi-12">e </span>= (<span 
class="cmmi-12">j,k</span>), so try <span 
class="cmmi-12">&#x03BB;</span><sub><span 
class="cmmi-8">jk</span></sub> = 1. One optimal solution to the
      Lagrangian relaxation is then to use the paths <span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">b </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">j </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">k </span>and <span 
class="cmmi-12">h </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">g </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">p </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">l </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">f</span>,
      with value 7. Since this solution is feasible in the multicommodity problem, it is
      optimal.
      <!--l. 490--><p class="noindent" >The constraint matrix for the Lagrangian Relaxation is TU, so the value of the LP relaxation
      is equal to the value of the Lagrangian Dual. One fractional solution to LP relaxation with
      value 7: flows of 0.5 along the 4 paths <span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">b </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">j </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">k</span>, <span 
class="cmmi-12">a </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">b </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">p </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">l </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">k</span>, <span 
class="cmmi-12">h </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">j </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">k </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">f</span>,
      <span 
class="cmmi-12">h </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">g </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">p </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">l </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">f</span>. This is the average of 2 optimal integral solutions to the LP
      relaxation.
      </li>
      <li 
  class="enumerate" id="x1-8x3">Consider the mixed integer programming problem (<span 
class="cmmi-12">MIP</span>):
      <center class="math-display" >
      <img 
src="hw6sol20217x.png" alt="max   8x1   +9x2  +5x3   +6x4   - 15y1  - 10y2
s.t.   x1           +x3                         &#x2264;   1
       x1                  +x4                  &#x2264;   1
              x     +x                          &#x2264;   1
                2      3
              x2           +x4                  &#x2264;   1
                                   - y1    - y2 &#x2264;   - 1
       x1                          - y1         &#x2264;   0
              x2                   - y1         &#x2264;   0
                     x                     - y  &#x2264;   0
                       3                     2
                            x4             - y2 &#x2264;   0
                                            xj  &#x2265;   0
                                             yi     binary
      " class="math-display" ></center>
                                                                                         
                                                                                         
      <!--l. 515--><p class="nopar" >
      Solve this problem using Bender&#8217;s decomposition. (Take the problem
      <center class="math-display" >
      <img 
src="hw6sol20218x.png" alt="max   z  - 15y1  - 10y2
s.t    z                  &#x2264;  28

                     yi     binary
      " class="math-display" ></center>
      <!--l. 524--><p class="nopar" >
      as the initial relaxation (<span 
class="cmmi-12">RMP</span>).)
      <!--l. 527--><p class="noindent" ><span 
class="cmbx-12">Solution: </span><br 
class="newline" />
      <!--l. 530--><p class="noindent" >Solution to (<span 
class="cmmi-12">RMP</span>) is <span class="bar-css"><span 
class="cmmi-12">z</span></span> = 28, <span class="bar-css"><span 
class="cmmi-12">y</span></span> = (0<span 
class="cmmi-12">, </span>0). Objective function for the subproblem is
      (<span 
class="cmmi-12">b </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">H</span><sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">y</span>)<sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">u </span>= <span 
class="cmmi-12">b</span><sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">u </span>since <span 
class="cmmi-12">y </span>= 0. Subproblem is:
      <center class="par-math-display" >
      <img 
src="hw6sol20219x.png" alt="minu        u1  +   u2  +   u3  +  u4  -   u5
subject to  u1  +   u2                         +   u6                         &#x2265;   8
                            u   +  u                   +   u                  &#x2265;   9      (SP )
                             3       4                      7
            u1          +   u3                                 +  u8          &#x2265;   5
                    u2          +  u4                                 +   u9  &#x2265;   6
                                                                           u  &#x2265;   0
      " class="par-math-display" ></center>
      <!--l. 544--><p class="nopar" >
      <!--l. 546--><p class="noindent" >Solution is unbounded, with a ray <span 
class="cmmi-12">r</span><sup><span 
class="cmr-8">1</span></sup> = (0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>1<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0)<sup><span 
class="cmmi-8">T</span> </sup>. Add constraint
      (<span 
class="cmmi-12">r</span><sup><span 
class="cmr-8">1</span></sup>)<sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">Hy </span><span 
class="cmsy-10x-x-120">&#x2264; </span><span 
class="cmmi-12">b</span><sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">r</span><sup><span 
class="cmr-8">1</span></sup> to (<span 
class="cmmi-12">RMP</span>):
      <center class="par-math-display" >
      <img 
src="hw6sol202110x.png" alt="max   z  -   15y1  -  10y2
s.t    z                      &#x2264;  28

         -     y1  -     y2  &#x2264;  - 1
                         yi     binary
      " class="par-math-display" ></center>
      <!--l. 556--><p class="nopar" >
                                                                                         
                                                                                         
      <!--l. 558--><p class="noindent" >Solution is <span class="bar-css"><span 
class="cmmi-12">y</span></span> = (0<span 
class="cmmi-12">, </span>1), <span class="bar-css"><span 
class="cmmi-12">z</span></span> = 28, with value 18. Updated subproblem with objective
      (<span 
class="cmmi-12">b </span><span 
class="cmsy-10x-x-120">- </span><span 
class="cmmi-12">H</span><sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">y</span>)<sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">u </span>is:
      <center class="par-math-display" >
      <img 
src="hw6sol202111x.png" alt="minu        u1  +   u2  +   u3  +  u4                      +  u8  +   u9
subject to  u   +   u                      +   u                          &#x2265;   8
             1       2                          6
                            u3  +  u4              +   u7                 &#x2265;   9      (SP )
            u1          +   u3                             +  u8          &#x2265;   5
                    u2          +  u4                             +   u9  &#x2265;   6
                                                                       u  &#x2265;   0
      " class="par-math-display" ></center>
      <!--l. 571--><p class="nopar" >
      <!--l. 573--><p class="noindent" >Optimal value is 11 <span 
class="cmmi-12">&#x003C;</span> <span class="bar-css"><span 
class="cmmi-12">z</span></span>. One solution is <span 
class="cmmi-12">u</span><sup><span 
class="cmr-8">1</span></sup> = (0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>8<span 
class="cmmi-12">, </span>9<span 
class="cmmi-12">, </span>5<span 
class="cmmi-12">, </span>6)<sup><span 
class="cmmi-8">T</span> </sup>. Add constraint
      <span 
class="cmmi-12">z </span>+ (<span 
class="cmmi-12">u</span><sup><span 
class="cmr-8">1</span></sup>)<sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">Hy </span><span 
class="cmsy-10x-x-120">&#x2264; </span><span 
class="cmmi-12">b</span><sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">u</span><sup><span 
class="cmr-8">1</span></sup> to (<span 
class="cmmi-12">RMP</span>):
      <center class="par-math-display" >
      <img 
src="hw6sol202112x.png" alt="max   z  -   15y1  -  10y2

s.t    z                      &#x2264;  28
         -     y1  -     y2  &#x2264;  - 1
      z  -   17y1  -  11y2   &#x2264;  0
                         yi     binary
      " class="par-math-display" ></center>
      <!--l. 587--><p class="nopar" >
      <!--l. 589--><p class="noindent" >Solution is <span class="bar-css"><span 
class="cmmi-12">y</span></span> = (1<span 
class="cmmi-12">, </span>1), <span class="bar-css"><span 
class="cmmi-12">z</span></span> = 28, with value 3. Updated subproblem with objective (<span 
class="cmmi-12">b</span><span 
class="cmsy-10x-x-120">-</span><span 
class="cmmi-12">H</span><sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">y</span>)<sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">u</span>
      is:
      <center class="par-math-display" >
      <img 
src="hw6sol202113x.png" alt="minu        u1  +   u2  +   u3  +  u4  +   u5  +   u6  +  u7   +  u8  +   u9
subject to  u1  +   u2                         +   u6                         &#x2265;   8
                            u3  +  u4                  +  u7                  &#x2265;   9      (SP )
            u           +   u                                  +  u           &#x2265;   5
             1               3                                     8
                    u2          +  u4                                 +   u9  &#x2265;   6
                                                                           u  &#x2265;   0
      " class="par-math-display" ></center>
                                                                                         
                                                                                         
      <!--l. 602--><p class="nopar" >
      <!--l. 604--><p class="noindent" >Optimal value is 17 <span 
class="cmmi-12">&#x003C;</span> <span class="bar-css"><span 
class="cmmi-12">z</span></span>. One solution is <span 
class="cmmi-12">u</span><sup><span 
class="cmr-8">2</span></sup> = (8<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>9<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0)<sup><span 
class="cmmi-8">T</span> </sup>. Add constraint
      <span 
class="cmmi-12">z </span>+ (<span 
class="cmmi-12">u</span><sup><span 
class="cmr-8">2</span></sup>)<sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">Hy </span><span 
class="cmsy-10x-x-120">&#x2264; </span><span 
class="cmmi-12">b</span><sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">u</span><sup><span 
class="cmr-8">2</span></sup> to (<span 
class="cmmi-12">RMP</span>):
      <center class="par-math-display" >
      <img 
src="hw6sol202114x.png" alt="max   z  -   15y1  -  10y2
s.t    z                      &#x2264;  28
         -     y   -     y   &#x2264;  - 1
                1         2
      z  -   17y1  -  11y2   &#x2264;  0
      z                      &#x2264;  17
                         yi     binary
      " class="par-math-display" ></center>
      <!--l. 618--><p class="nopar" >
      <!--l. 620--><p class="noindent" >Solution is <span class="bar-css"><span 
class="cmmi-12">y</span></span> = (1<span 
class="cmmi-12">, </span>0), <span class="bar-css"><span 
class="cmmi-12">z</span></span> = 17, with value 2. Updated subproblem with objective (<span 
class="cmmi-12">b</span><span 
class="cmsy-10x-x-120">-</span><span 
class="cmmi-12">H</span><sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">y</span>)<sup><span 
class="cmmi-8">T</span> </sup><span 
class="cmmi-12">u</span>
      is:
      <center class="par-math-display" >
      <img 
src="hw6sol202115x.png" alt="minu        u1  +   u2  +   u3  +  u4      +   u6  +   u7
subject to  u1  +   u2                     +   u6                         &#x2265;   8
                            u3  +  u4              +   u7                 &#x2265;   9      (SP )
            u1          +   u3                             +  u8          &#x2265;   5

                    u2          +  u4                             +   u9  &#x2265;   6
                                                                       u  &#x2265;   0
      " class="par-math-display" ></center>
      <!--l. 633--><p class="nopar" >
      <!--l. 635--><p class="noindent" >Optimal value is 17 = <span class="bar-css"><span 
class="cmmi-12">z</span></span>. The point <span 
class="cmmi-12">u</span><sup><span 
class="cmr-8">2</span></sup> is still optimal to the subproblem. So we have the
      optimal solution to the master problem, namely <span class="bar-css"><span 
class="cmmi-12">y</span></span> = (1<span 
class="cmmi-12">, </span>0) with <span class="bar-css"><span 
class="cmmi-12">z</span></span> = 17. Fixing this choice of
      <span 
class="cmmi-12">y </span>in the original (<span 
class="cmmi-12">MIP</span>) gives the solution <span 
class="cmmi-12">x </span>= (8<span 
class="cmmi-12">, </span>9<span 
class="cmmi-12">, </span>0<span 
class="cmmi-12">, </span>0), which is the <span 
class="cmmi-12">x </span>portion of the
      optimal solution. The optimal value is indeed&#x00A0;2.
      </li>
      <li 
  class="enumerate" id="x1-10x4">We are going to consider a column generation approach to solving clustering problems. We
      have <span 
class="cmmi-12">n </span>objects we wish to cluster, with each cluster containing at least 4 objects. Let <span 
class="cmmi-12">d</span><sub><span 
class="cmmi-8">jk</span></sub> be
      the cost of clustering object <span 
class="cmmi-12">j </span>with object <span 
class="cmmi-12">k </span>(the cost <span 
class="cmmi-12">d</span><sub><span 
class="cmmi-8">jk</span></sub> may be negative). The cost of a
      cluster <span 
class="cmmi-12">C </span>is
                                                                                         
                                                                                         
      <center class="math-display" >
      <img 
src="hw6sol202116x.png" alt="        1 &#x2211;   &#x2211;
w(C ) = --       djk.
        2 j&#x2208;C k&#x2208;C
      " class="math-display" ></center>
      <!--l. 654--><p class="nopar" >
      We define a binary variable
      <center class="math-display" >
      <img 
src="hw6sol202117x.png" alt="     {
xi =    1  if cluster Ci is chosen in the clustering
        0  otherwise
      " class="math-display" ></center>
      <!--l. 661--><p class="nopar" >
      Let <span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-43.png" alt="C" class="10-120x-x-43" /> </span>denote the set of all valid clusters. We can then define the clustering problem
      as
      <center class="math-display" >
      <img 
src="hw6sol202118x.png" alt="            &#x2211;
minx           Ci&#x2208;C w(Ci )xi
subject to      &#x2211;       xi  =   1  for j = 1, ...,n
                  Ci:j&#x2208;Ci
                         x      binary
      " class="math-display" ></center>
      <!--l. 670--><p class="nopar" >
      In the LP relaxation, the binary restriction on <span 
class="cmmi-12">x </span>is replaced by the requirement that <span 
class="cmmi-12">x </span><span 
class="cmsy-10x-x-120">&#x2265; </span>0.
      The dual to the LP relaxation is
      <center class="math-display" >
      <img 
src="hw6sol202119x.png" alt="             &#x2211;n
maxy &#x2208;&#x211D;n    &#x2211;  j=1yj
subject to    j&#x2208;Ci yj &#x2264;   w(Ci ) for all Ci &#x2208; C
      " class="math-display" ></center>
      <!--l. 679--><p class="nopar" >
      In a column generation approach, we work with a subset of&#x00A0;<span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-43.png" alt="C" class="10-120x-x-43" /></span>. Solving the LP
      relaxation and its dual for this subset gives a vector <span class="bar-css"><span 
class="cmmi-12">y</span></span> of dual multipliers. We have
      then solved the LP relaxation for the full set <span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-43.png" alt="C" class="10-120x-x-43" /> </span>if <span class="bar-css"><span 
class="cmmi-12">y</span></span> is feasible in the full dual
      problem.
      <!--l. 686--><p class="noindent" >Construct a quadratic binary program to determine whether <span class="bar-css"><span 
class="cmmi-12">y</span></span> is feasible for the full
      set&#x00A0;<span 
class="cmsy-10x-x-120"><img 
src="cmsy10-c-43.png" alt="C" class="10-120x-x-43" /></span>. Reformulate the quadratic binary program as an equivalent integer linear
      program.
                                                                                         
                                                                                         
      <!--l. 691--><p class="noindent" ><span 
class="cmbx-12">Solution:</span>
      <!--l. 693--><p class="noindent" >We have a violated dual constraint if there exists a valid cluster <span 
class="cmmi-12">C </span>with
      <center class="math-display" >
      <img 
src="hw6sol202120x.png" alt="        &#x2211;                                 &#x2211;
w(C ) &#x003C;     ¯yj,  or equivalently   w (C ) -     ¯yj &#x003C; 0.
        j&#x2208;C                               j&#x2208;C
      " class="math-display" ></center>
      <!--l. 697--><p class="nopar" >
      Define binary variables
      <center class="math-display" >
      <img 
src="hw6sol202121x.png" alt="      {
zj =    1  if j &#x2208; C
        0  otherwise
      " class="math-display" ></center>
      <!--l. 704--><p class="nopar" >
      We can then set up the quadratic integer program
      <center class="math-display" >
      <img 
src="hw6sol202122x.png" alt="            1&#x2211;     &#x2211;               &#x2211;n
minz&#x2208;&#x211D;n    &#x2211;2   j&#x2208;C   k&#x2208;C djkzjzk -    j=1 ¯yjzj
subject to     nj=1zj  &#x2265;   4

                  z      binary
      " class="math-display" ></center>
      <!--l. 713--><p class="nopar" >
      The solution <span class="bar-css"><span 
class="cmmi-12">y</span></span> is optimal if the optimal value of this IQP is nonnegative.
      <!--l. 717--><p class="noindent" >We can use the McCormick inequalties to turn this into an equivalent integer linear program.
      We define the variable <span 
class="cmmi-12">&#x03D5;</span><sub><span 
class="cmmi-8">jk</span></sub>, which we want to equal the product <span 
class="cmmi-12">z</span><sub><span 
class="cmmi-8">j</span></sub><span 
class="cmmi-12">z</span><sub><span 
class="cmmi-8">k</span></sub>. The ILP is
      then
      <center class="math-display" >
      <img 
src="hw6sol202123x.png" alt="min    n    1&#x2211;     &#x2211;     d  &#x03D5;   -  &#x2211;n   ¯y z
    z&#x2208;&#x211D;     2&#x2211;n  j&#x2208;C    k&#x2208;C  jk  jk      j=1 j j
subject to    j=1zj  &#x2265;   4
                &#x03D5;    &#x2264;   z           for j,k = 1,...,n
                  jk       j
                &#x03D5;jk  &#x2264;   zk          for j,k = 1,...,n
                &#x03D5;jk  &#x2265;   zj + zk - 1 for j,k = 1,...,n
                z,&#x03D5;      binary
      " class="math-display" ></center>
                                                                                         
                                                                                         
      <!--l. 731--><p class="nopar" >
      </li>
      <li 
  class="enumerate" id="x1-12x5">In the following picture,
      <div class="center" 
>
<!--l. 737--><p class="noindent" >
<!--l. 738--><p class="noindent" ><img 
src="vietnam.png" alt="PIC"  
></div>
      <!--l. 740--><p class="noindent" >it is desired to place each of the numbers 1,&#x2026;,9 into exactly one of the nine empty positions so
      that the equation is correct. Note that the colon symbol is used to denote division, and the
      standard arithmetic rules apply so division and multiplication are performed before addition
      and subtraction.
           <ol  class="enumerate2" >
           <li 
  class="enumerate" id="x1-14x1">Formulate the problem as a mixed integer nonlinear feasibility program.
           </li>
           <li 
  class="enumerate" id="x1-16x2">Use the McCormick inequalities to express it as an equivalent mixed integer <span 
class="cmti-12">linear</span>
           feasibility program, and hence solve it.</li></ol>
      <!--l. 751--><p class="noindent" ><span 
class="cmbx-12">Solution:</span>
           <ol  class="enumerate2" >
           <li 
  class="enumerate" id="x1-18x1">We index the nine positions from the start of the snake to the end. We define binary
           variables
           <center class="math-display" >
           <img 
src="hw6sol202124x.png" alt="      {
         1  if number  i is placed in position j
xij =    0  otherwise
           " class="math-display" ></center>
           <!--l. 763--><p class="nopar" >
           We also define binary variables <span 
class="cmmi-12">y</span><sub><span 
class="cmmi-8">ik</span></sub> = <span 
class="cmmi-12">x</span><sub><span 
class="cmmi-8">i</span><span 
class="cmr-8">2</span></sub><span 
class="cmmi-12">x</span><sub><span 
class="cmmi-8">k</span><span 
class="cmr-8">3</span></sub> to represent the division at the end of the
           first column, and <span 
class="cmmi-12">z</span><sub><span 
class="cmmi-8">ikl</span></sub> = <span 
class="cmmi-12">x</span><sub><span 
class="cmmi-8">i</span><span 
class="cmr-8">7</span></sub><span 
class="cmmi-12">x</span><sub><span 
class="cmmi-8">k</span><span 
class="cmr-8">8</span></sub><span 
class="cmmi-12">x</span><sub><span 
class="cmmi-8">l</span><span 
class="cmr-8">9</span></sub> to represent the choice for the last three slots. We can
           then set up the feasibility problem
           <center class="math-display" >
           <img 
src="hw6sol202125x.png" alt="Fi&#x2211;nd  x, y, z satis&#x2211;fying&#x2211;           &#x2211;              &#x2211;           &#x2211;
    9i=1 ixi1 + 13  9i=1   9k=1-iyik +    9i=1 ixi4 + 12   9i=1ixi5 -   9i=1ixi6 - 11
              &#x2211;9   &#x2211;9    &#x2211;9k
           +    i=1   k=1   l=1 ikl zikl - 10 = 66
 &#x2211;9
    j=1xij = 1 for i = 1,...,9
 &#x2211;9    xij = 1 for j = 1,...,9
    i=1
 yik = xi2xk3 for i = 1,...,9,k = 1,...,9
 zikl = xi7xk8xl9 for i = 1,...,9,k = 1, ...,9,l = 1, ...,9
 &#x2211;9           &#x2211;9
    i=1 ixi1 &#x2265;   k=1 kxk4 + 1
 &#x2211;9           &#x2211;9
    i=1 ixi7 &#x2265;   k=1 kxk8 + 1
 xij binary  for i = 1,...,9,j = 1,...,9.
           " class="math-display" ></center>
           <!--l. 790--><p class="nopar" >
           The inequality constraints are for symmetry-busting. Note that the constraints imply
           each <span 
class="cmmi-12">y</span><sub><span 
class="cmmi-8">ik</span></sub> and <span 
class="cmmi-12">z</span><sub><span 
class="cmmi-8">ikl</span></sub> are binary, and that <span 
class="cmmi-12">y</span><sub><span 
class="cmmi-8">ii</span></sub> = 0<span style="margin-left:0.3em" class="thinspace"></span><span 
class="cmsy-10x-x-120">&#x2200;</span><span style="margin-left:0.3em" class="thinspace"></span><span 
class="cmmi-12">i</span>, <span 
class="cmmi-12">z</span><sub><span 
class="cmmi-8">iil</span></sub> = <span 
class="cmmi-12">z</span><sub><span 
class="cmmi-8">ili</span></sub> = <span 
class="cmmi-12">z</span><sub><span 
class="cmmi-8">lii</span></sub> = 0<span style="margin-left:0.3em" class="thinspace"></span><span 
class="cmsy-10x-x-120">&#x2200;</span><span style="margin-left:0.3em" class="thinspace"></span><span 
class="cmmi-12">i,l</span>.
           </li>
           <li 
  class="enumerate" id="x1-20x2">We can express the problem as the following equivalent mixed integer <span 
class="cmti-12">linear </span>program by
           using the McCormick inequalities:
           <center class="math-display" >
           <img 
src="hw6sol202126x.png" alt="Fi&#x2211;nd  x, y, z, w s&#x2211;atisfy&#x2211;ing        &#x2211;              &#x2211;           &#x2211;
    9i=1 ixi1 + 13  9i=1   9k=1-iyik +    9i=1 ixi4 + 12   9i=1ixi5 -   9i=1ixi6 - 11
              &#x2211;9   &#x2211;9    &#x2211;9k
           +    i=1   k=1   l=1 ikl zikl - 10 = 66
 &#x2211;9
    j=1xij = 1 for i = 1,...,9
 &#x2211;9    xij = 1 for j = 1,...,9
    i=1
 yik &#x2264; xi2 for i = 1,...,9,k = 1,...,9
 yik &#x2264; xk3 for i = 1,...,9,k = 1,...,9
 yik &#x2265; xi2 + xk3 - 1 for i = 1, ...,9,k = 1,...,9

 wik &#x2264;  xi7 for i = 1,...,9, k = 1,...,9
 wik &#x2264;  xk8 for i = 1,...,9,k = 1,...,9
 wik &#x2265;  xi7 + xk8 - 1 for i = 1,...,9,k =  1,...,9
 zikl &#x2264; wik for i = 1,...,9,k = 1,...,9
 z   &#x2264;  x  for i = 1,...,9,k = 1,...,9
  ikl    l9
 zikl &#x2265; wik + xl9 - 1 for i = 1,...,9,k = 1, ...,9
 &#x2211;9    ixi1 &#x2265; &#x2211;9    kxk4 + 1
 &#x2211;9 i=1        &#x2211;9k=1
    i=1 ixi7 &#x2265;   k=1 kxk8 + 1

 xij binary  for i = 1,...,9,j = 1,...,9
 yik binary  for i = 1,...,9,k = 1,...,9
 wik binary  for i = 1,...,9, k = 1,...,9
 zikl binary for i = 1,...,9,k = 1,...,9,l = 1,...,9
           " class="math-display" ></center>
           <!--l. 829--><p class="nopar" >
           Note we&#8217;ve represented <span 
class="cmmi-12">z</span><sub><span 
class="cmmi-8">ikl</span></sub> = <span 
class="cmmi-12">w</span><sub><span 
class="cmmi-8">ik</span></sub><span 
class="cmmi-12">x</span><sub><span 
class="cmmi-8">l</span><span 
class="cmr-8">9</span></sub> and <span 
class="cmmi-12">w</span><sub><span 
class="cmmi-8">ik</span></sub> = <span 
class="cmmi-12">x</span><sub><span 
class="cmmi-8">i</span><span 
class="cmr-8">7</span></sub><span 
class="cmmi-12">x</span><sub><span 
class="cmmi-8">k</span><span 
class="cmr-8">8</span></sub>.</li></ol>
      <!--l. 833--><p class="noindent" >One solution returned by AMPL is:
      <center class="math-display" >
      <img 
src="hw6sol202127x.png" alt="x13 = x25 = x32 = x49 = x56 = x64 = x77 = x88 = x91 = 1.
      " class="math-display" ></center>
      <!--l. 836--><p class="nopar" >
      <!--l. 848--><p class="noindent" >Apparently, there are multiple solutions to this problem, see <a 
href="https://www.theguardian.com/science/alexs-adventures-in-numberland/2015/may/20/can-you-do-the-maths-puzzle-for-vietnamese-eight-year-olds-that-has-stumped-parents-and-teachers" >this article</a>.
      </li></ol>
   <div class="tabular"> <table id="TBL-3" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-3-1g"><col 
id="TBL-3-1"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-3-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-1-1"  
class="td01">&#x00A0;&#x00A0;&#x00A0;         <a 
href="http://www.rpi.edu/~mitchj" >John Mitchell</a>                                                      </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-2-1"  
class="td01">&#x00A0;&#x00A0;&#x00A0; Amos Eaton 325</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-3-1"  
class="td01">&#x00A0;&#x00A0;&#x00A0;         x6915.                                                                 </td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-4-1"  
class="td01">&#x00A0;&#x00A0;&#x00A0; <a 
href="mailto:mitchj@rpi.edu" >mitchj at rpi dot edu</a></td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-5-1"  
class="td01">&#x00A0;&#x00A0;&#x00A0;         Office hours: Monday and Thursday 1pm&#8211;2pm.           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-3-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-3-6-1"  
class="td01">&#x00A0;&#x00A0;&#x00A0;         webex: <a 
href="https://rensselaer.webex.com/meet/mitchj" class="url" ><span 
class="cmtt-12">https://rensselaer.webex.com/meet/mitchj</span></a></td> </tr></table>
</div>
                                                                                         
                                                                                         
    
</body></html> 

                                                                                         


