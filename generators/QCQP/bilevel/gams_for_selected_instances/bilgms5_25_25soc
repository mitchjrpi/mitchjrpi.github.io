* problem bilgms
SET xVars   /x1*x5/;
SET yVars   /y1*y25/;
SET bLinCons   /bcon1*bcon25/;
PARAMETER c(xVars)
  /  
x1   4.00000000e+00 
x2   1.00000000e+00 
x3  -5.00000000e+00 
x4  -4.00000000e+00 
x5  -2.00000000e+00 
 / 
 
PARAMETER d(xVars)
  /  
x1  -1.00000000e+00 
x2  -8.00000000e+00 
x3   3.00000000e+00 
x4   4.00000000e+00 
x5  -9.00000000e+00 
 / 
 
PARAMETER b(bLinCons)
  /  
bcon1   0.00000000e+00 
bcon2   2.00000000e+00 
bcon3  -5.00000000e+00 
bcon4   0.00000000e+00 
bcon5  -3.00000000e+00 
bcon6   4.00000000e+00 
bcon7  -5.50000000e+00 
bcon8  -1.00000000e+00 
bcon9   5.00000000e-01 
bcon10   6.00000000e+00 
bcon11  -3.00000000e+00 
bcon12   0.00000000e+00 
bcon13  -6.00000000e+00 
bcon14  -5.00000000e-01 
bcon15  -5.00000000e-01 
bcon16   2.50000000e+00 
bcon17   1.50000000e+00 
bcon18   2.00000000e+00 
bcon19  -6.00000000e+00 
bcon20   6.00000000e+00 
bcon21   1.50000000e+00 
bcon22  -5.50000000e+00 
bcon23   1.00000000e+00 
bcon24  -5.50000000e+00 
bcon25   3.50000000e+00 
 / 
 
PARAMETER g(yVars)
  /  
y1   1.50000000e+01 
y2   2.00000000e+01 
y3   2.10000000e+01 
y4   2.00000000e+01 
y5   1.90000000e+01 
y6   1.50000000e+01 
y7   1.60000000e+01 
y8   1.10000000e+01 
y9   1.30000000e+01 
y10   1.70000000e+01 
y11   1.20000000e+01 
y12   1.50000000e+01 
y13   1.50000000e+01 
y14   1.20000000e+01 
y15   1.80000000e+01 
y16   1.90000000e+01 
y17   1.50000000e+01 
y18   1.80000000e+01 
y19   2.20000000e+01 
y20   1.30000000e+01 
y21   2.00000000e+01 
y22   2.00000000e+01 
y23   1.60000000e+01 
y24   1.40000000e+01 
y25   1.80000000e+01 
 / 
 
TABLE Bmat(bLinCons,xVars)
                x1                 x2                 x3                 x4                 x5                
bcon1  2.00000000e+00      1.00000000e+00      5.00000000e+00     -2.00000000e+00     -5.00000000e+00    
bcon2  3.00000000e+00     -1.00000000e+00     -4.00000000e+00      3.00000000e+00      4.00000000e+00    
bcon3  1.00000000e+00     -3.00000000e+00     -3.00000000e+00      0.00000000e+00     -4.00000000e+00    
bcon4 -5.00000000e+00     -2.00000000e+00      3.00000000e+00      2.00000000e+00      3.00000000e+00    
bcon5  0.00000000e+00     -5.00000000e+00      2.00000000e+00      0.00000000e+00     -2.00000000e+00    
bcon6  1.00000000e+00     -1.00000000e+00      5.00000000e+00      1.00000000e+00      3.00000000e+00    
bcon7 -5.00000000e+00     -2.00000000e+00     -4.00000000e+00     -2.00000000e+00      3.00000000e+00    
bcon8  0.00000000e+00     -3.00000000e+00      3.00000000e+00      2.00000000e+00     -3.00000000e+00    
bcon9  1.00000000e+00     -1.00000000e+00     -5.00000000e+00      4.00000000e+00      3.00000000e+00    
bcon10  4.00000000e+00     -1.00000000e+00      0.00000000e+00      5.00000000e+00      5.00000000e+00    
bcon11 -1.00000000e+00     -5.00000000e+00     -4.00000000e+00      1.00000000e+00      4.00000000e+00    
bcon12  4.00000000e+00     -2.00000000e+00      3.00000000e+00      0.00000000e+00     -4.00000000e+00    
bcon13 -1.00000000e+00     -5.00000000e+00      3.00000000e+00     -3.00000000e+00     -5.00000000e+00    
bcon14  2.00000000e+00      0.00000000e+00      4.00000000e+00     -4.00000000e+00     -2.00000000e+00    
bcon15  3.00000000e+00      1.00000000e+00     -1.00000000e+00     -2.00000000e+00     -1.00000000e+00    
bcon16  0.00000000e+00      2.00000000e+00      4.00000000e+00      0.00000000e+00      0.00000000e+00    
bcon17  2.00000000e+00      2.00000000e+00      1.00000000e+00      2.00000000e+00     -3.00000000e+00    
bcon18 -1.00000000e+00      3.00000000e+00     -4.00000000e+00      4.00000000e+00      3.00000000e+00    
bcon19  0.00000000e+00      0.00000000e+00     -2.00000000e+00     -5.00000000e+00     -4.00000000e+00    
bcon20 -1.00000000e+00     -1.00000000e+00      5.00000000e+00      5.00000000e+00      5.00000000e+00    
bcon21 -5.00000000e+00      0.00000000e+00      3.00000000e+00      4.00000000e+00      2.00000000e+00    
bcon22 -4.00000000e+00     -1.00000000e+00     -5.00000000e+00      0.00000000e+00      0.00000000e+00    
bcon23 -4.00000000e+00      2.00000000e+00      2.00000000e+00      3.00000000e+00      0.00000000e+00    
bcon24 -4.00000000e+00     -3.00000000e+00      0.00000000e+00      0.00000000e+00     -3.00000000e+00    
bcon25  1.00000000e+00      2.00000000e+00     -4.00000000e+00      5.00000000e+00      4.00000000e+00    
 ;

TABLE Hmat(yVars,xVars)
                x1                 x2                 x3                 x4                 x5                
y1  2.00000000e+00      2.00000000e+00      4.00000000e+00      4.00000000e+00      4.00000000e+00    
y2  4.00000000e+00      5.00000000e+00      2.00000000e+00      5.00000000e+00      5.00000000e+00    
y3  4.00000000e+00      5.00000000e+00      5.00000000e+00      5.00000000e+00      3.00000000e+00    
y4  5.00000000e+00      3.00000000e+00      3.00000000e+00      5.00000000e+00      5.00000000e+00    
y5  5.00000000e+00      5.00000000e+00      2.00000000e+00      3.00000000e+00      5.00000000e+00    
y6  2.00000000e+00      3.00000000e+00      5.00000000e+00      2.00000000e+00      4.00000000e+00    
y7  4.00000000e+00      3.00000000e+00      5.00000000e+00      2.00000000e+00      3.00000000e+00    
y8  2.00000000e+00      2.00000000e+00      2.00000000e+00      3.00000000e+00      3.00000000e+00    
y9  2.00000000e+00      3.00000000e+00      3.00000000e+00      2.00000000e+00      4.00000000e+00    
y10  4.00000000e+00      4.00000000e+00      3.00000000e+00      4.00000000e+00      3.00000000e+00    
y11  2.00000000e+00      2.00000000e+00      3.00000000e+00      4.00000000e+00      2.00000000e+00    
y12  4.00000000e+00      3.00000000e+00      3.00000000e+00      2.00000000e+00      4.00000000e+00    
y13  5.00000000e+00      4.00000000e+00      2.00000000e+00      3.00000000e+00      2.00000000e+00    
y14  2.00000000e+00      2.00000000e+00      2.00000000e+00      5.00000000e+00      2.00000000e+00    
y15  3.00000000e+00      2.00000000e+00      4.00000000e+00      5.00000000e+00      5.00000000e+00    
y16  4.00000000e+00      4.00000000e+00      4.00000000e+00      4.00000000e+00      4.00000000e+00    
y17  3.00000000e+00      3.00000000e+00      3.00000000e+00      5.00000000e+00      2.00000000e+00    
y18  2.00000000e+00      5.00000000e+00      4.00000000e+00      5.00000000e+00      3.00000000e+00    
y19  4.00000000e+00      5.00000000e+00      5.00000000e+00      4.00000000e+00      5.00000000e+00    
y20  4.00000000e+00      3.00000000e+00      3.00000000e+00      2.00000000e+00      2.00000000e+00    
y21  4.00000000e+00      5.00000000e+00      5.00000000e+00      4.00000000e+00      3.00000000e+00    
y22  5.00000000e+00      5.00000000e+00      5.00000000e+00      4.00000000e+00      2.00000000e+00    
y23  3.00000000e+00      4.00000000e+00      4.00000000e+00      4.00000000e+00      2.00000000e+00    
y24  2.00000000e+00      3.00000000e+00      4.00000000e+00      4.00000000e+00      2.00000000e+00    
y25  5.00000000e+00      3.00000000e+00      2.00000000e+00      4.00000000e+00      5.00000000e+00    
 ;

*ampl res : LPlb  -1.00000000e+30, QRlb  -1.53045138e+01

VARIABLES z
          x(xVars)
          sigma(xVars)
          ytilde(xVars);

POSITIVE VARIABLES w(xVars)
                   y(yVars)
                   s(yVars);

EQUATIONS
   OBJective
   wub(xVars)
   bcon(bLinCons)
   gcon(yVars)
   KKT(xVars)
   def_ytilde(xVars)
   quadcon(xVars)
   lifted_compl
   lifting(xVars);

OBJective.. z =e= SUM(xVars, c(xVars) * x(xVars))
  + SUM(xVars, d(xVars) *w(xVars));

wub(xVars)..  w(xVars) =l= 1;

bcon(bLinCons)..
  SUM(xVars, Bmat(bLinCons,xVars)*w(xVars)) =g= b(bLinCons);

gcon(yVars)..
  SUM(xVars, Hmat(yVars,xVars)*x(xVars)) -s(yVars) =e= g(yVars);

KKT(xVars)..
  x(xVars) + w(xVars) - ytilde(xVars) =e= 0;

def_ytilde(xVars)..
  ytilde(xVars) -
    SUM(yVars, Hmat(yVars,xVars)*y(yVars)) =e= 0;

quadcon(xVars)..
  (x(xVars) + ytilde(xVars))**2 - 4*sigma(xVars) 
    - w(xVars) =l= 0;

lifted_compl..
SUM(xVars,sigma(xVars)) 
    - SUM(yVars, g(yVars)*y(yVars)) =l= 0;

lifting(xVars)..
   sigma(xVars) - x(xVars)*ytilde(xVars) =e= 0;

model bilgms  /all/;

solve bilgms using nlp minimizing z;
